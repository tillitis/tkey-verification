.\" Generated by scdoc 1.11.3
.\" Complete documentation for this program is not available as a GNU info page
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.nh
.ad l
.\" Begin generated content:
.TH "tkey-verification" "1" "2025-09-10"
.PP
.SH NAME
.PP
tkey-verification - sign the identity of a Tillitis TKey.\&
.PP
.SH SYNOPSIS
.PP
\fBtkey-verification\fR -h/--help
.PP
\fBtkey-verification\fR remote-sign [--port port] [--speed speed]
.PP
\fBtkey-verification\fR serve-signer [--config path] [--check-config] [--port
port] [--speed speed]
.PP
\fBtkey-verification\fR show-pubkey [--port port] [--speed speed] --app path
.PP
.SH DESCRIPTION
.PP
\fBtkey-verification\fR signs the identity of a Tillitis TKey.\&
.PP
A typical end user will only be interested in the \fBtkey-verify\fR(1)
command.\& \fBtkey-verification\fR is for the vendor.\&
.PP
The commands are as follows:
.PP
\fBremote-sign\fR
.PP
.RS 4
Request that the \fBtkey-verification\fR serve-signer sign the identity
of a TKey.\&
.PP
To use, first insert a TKey and then run the command.\&
.PP
Options:
.PP
\fB--port\fR port
.PP
.RS 4
Path to the TKey device port.\& If not given, autodetection will be
attempted.\&
.PP
.RE
\fB--speed\fR speed
.PP
.RS 4
Speed in bit/s of the TKey device port.\&
.PP
.RE
.RE
\fBserve-signer\fR
.PP
.RS 4
Provide a signing server with its own TKey, the vendor key.\&
.PP
When it receives a signing request from \fBremote-sign\fR it signs the
message and creates a new file with metadata and a Sigsum log
request.\& See FILES.\&
.PP
Options:
.PP
\fB--config\fR path
.PP
.RS 4
Path to the configuration file.\&
.PP
.RE
\fB--check-config\fR
.PP
.RS 4
Check if the configuration file is OK and exit.\&
.PP
.RE
\fB--port\fR port
.PP
.RS 4
Path to the TKey device port.\& If not given, autodetection will be
attempted.\&
.PP
.RE
\fB--speed\fR speed
.PP
.RS 4
Speed in bit/s of the TKey device port.\&
.PP
.RE
.RE
\fBshow-pubkey\fR
.PP
.RS 4
Output public key data to populate the embedded vendor pubkeys
for building into \fBtkey-verification\fR to be able to use some other
commands.\& This is necessary in order to bootstrap \fBtkey-verification\fR
from scratch or to add another vendor signing key.\&
.PP
The output includes public key, app tag, and app hash in the
right format for the file.\&
.PP
Use the \fB--app\fR to specify the path of the app to load.\&
.PP
Options:
.PP
\fB--app\fR path
.PP
.RS 4
Load app in \fBpath\fR into TKey.\&
.PP
.RE
\fB--port\fR port
.PP
.RS 4
Path to the TKey device port.\& If not given, autodetection will be
attempted.\&
.PP
.RE
\fB--speed\fR speed
.PP
.RS 4
Speed in bit/s of the TKey device port.\&
.PP
.RE
.RE
.SH FILES
.PP
\fBtkey-verification\fR serve-signer produces a submission file which is
named after the Unique Device Identifier (in hexadecimal) for every
signature made.\& An example filename would be
"signatures/0133704100000015".\&
.PP
The file contains:
.PP
.PD 0
.IP \(bu 4
timestamp: RFC3339 UTC timestamp when the signature was done.\&
.IP \(bu 4
tag: The Git tag of the signer program used on the device under
verification,
.IP \(bu 4
request: A Sigsum request to log a digest of our message.\&
.PD
.PP
The files generated will later be submitted to a Sigsum log with
\fBtkey-sigsum-submit\fR(1).\&
.PP
.SH EXAMPLES
.PP
Run the signing server with a vendor key TKey inserted:
.PP
.nf
.RS 4
$ tkey-verification serve-signer --config tkey-verification-server\&.yaml
.fi
.RE
.PP
On the provisioning computer, insert the new TKey and run:
.PP
.nf
.RS 4
$ tkey-verification remote-sign --config tkey-verification-client\&.yaml
.fi
.RE
.PP
In order to include a new vendor signing key and Sigsum submit key, use:
.PP
.nf
.RS 4
$ tkey-verification show-pubkey --app internal/appbins/bins/signer-v1\&.0\&.1\&.bin
Public Key, app tag, and app hash for embedded vendor pubkeys follows on stdout:
03a7bd3be67cb466869904ec14b9974ebcc6e593abdc4151315ace2511b9c94d signer-v1\&.0\&.1 cd3c4f433f84648428113bd0a0cc407b2150e925a51b478006321e5a903c1638ce807138d1cc1f8f03cfb6236a87de0febde3ce0ddf177208e5483d1c169bac4
SSH version: ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIAOnvTvmfLRmhpkE7BS5l068xuWTq9xBUTFaziURuclN sigsum key
.fi
.RE
.PP
.SS SEE ALSO
.PP
\fBtkey-sigsum-submit\fR(1) \fBtkey-verify\fR(1)
.PP
.SH AUTHORS
.PP
Tillitis AB, https://tillitis.\&se/
.PP
.SH CAVEATS
.PP
You can currently not use several TKeys on the same computer at the
same time, which means you can'\&t use \fBserve-signer\fR and the other
commands on the same computer, unless you start them with \fB--port\fR.\&
.PP
.SH SECURITY CONSIDERATIONS
.PP
You probably shouldn'\&t expose the computers running \fBserve-signer\fR or
\fBremote-sign\fR on the Internet.\&
